Los pasos PRINCIPALES que describen la construcción del flujo de datos en el segundo ejemplo siguen siendo los mismos que en el primero, a pesar de tener más detalles e información adicional.  

Por lo tanto, la respuesta también es **5**. 

Los pasos principales siguen siendo:

1. **Configuración Inicial:** Preparación del entorno.
2. **Cloud Storage:** Creación del bucket y subida del archivo.
3. **Cloud Functions:** Desarrollo, configuración y despliegue de la función.
4. **BigQuery:** Creación del dataset para almacenar los datos.
5. **Prueba del Flujo:** Verificación del funcionamiento del proceso completo. 
